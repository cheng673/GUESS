<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>手機傾斜偵測測試</title>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
        }
        #container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            width: 80%;
        }
        /* 視覺化小球 */
        #ball-track {
            width: 200px;
            height: 200px;
            border: 2px solid #333;
            border-radius: 50%;
            margin: 20px auto;
            position: relative;
            background: #eee;
        }
        #ball {
            width: 30px;
            height: 30px;
            background: #007AFF;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: 0.1s ease-out;
        }
        button {
            padding: 12px 24px;
            font-size: 16px;
            background-color: #007AFF;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        .data {
            margin-top: 15px;
            font-family: monospace;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>

<div id="container">
    <h2>傾斜偵測</h2>
    <p>請點擊下方按鈕啟動感測器</p>
    
    <button id="askButton">啟動感測器</button>

    <div id="ball-track">
        <div id="ball"></div>
    </div>

    <div class="data">
        <div>Beta (前後): <span id="beta">0</span>°</div>
        <div>Gamma (左右): <span id="gamma">0</span>°</div>
    </div>
</div>

<script>
    const ball = document.getElementById('ball');
    const betaDisplay = document.getElementById('beta');
    const gammaDisplay = document.getElementById('gamma');
    const btn = document.getElementById('askButton');

    function handleOrientation(event) {
        // 獲取數值
        let beta = event.beta;  // -180 到 180 (前後)
        let gamma = event.gamma; // -90 到 90 (左右)

        // 更新文字顯示
        betaDisplay.textContent = Math.round(beta);
        gammaDisplay.textContent = Math.round(gamma);

        // 移動小球位置 (限制移動範圍在圓圈內)
        // 為了演示，我們將角度映射到像素位置
        let x = gamma * 2; // 左右移動
        let y = beta * 2;  // 前後移動

        ball.style.transform = `translate(calc(-50% + ${x}px), calc(-50% + ${y}px))`;
    }

    btn.addEventListener('click', function() {
        // 針對 iOS 13+ 的權限請求處理
        if (typeof DeviceOrientationEvent.requestPermission === 'function') {
            DeviceOrientationEvent.requestPermission()
                .then(permissionState => {
                    if (permissionState === 'granted') {
                        window.addEventListener('deviceorientation', handleOrientation);
                        btn.style.display = 'none'; // 取得權限後隱藏按鈕
                    }
                })
                .catch(console.error);
        } else {
            // 一般 Android 或較舊版本瀏覽器
            window.addEventListener('deviceorientation', handleOrientation);
            btn.style.display = 'none';
        }
    });
</script>

</body>
</html>
